<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>基于.NET6的简单三层管理系统 | 芦荟柚子茶的博客</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="cl_lis blog">
    
    <link rel="preload" href="/blog/assets/css/0.styles.0b1ac558.css" as="style"><link rel="preload" href="/blog/assets/js/app.558beeb7.js" as="script"><link rel="preload" href="/blog/assets/js/2.c9b070a5.js" as="script"><link rel="preload" href="/blog/assets/js/12.366feb7b.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.ab0a2d87.js"><link rel="prefetch" href="/blog/assets/js/11.0cc953f3.js"><link rel="prefetch" href="/blog/assets/js/13.c133c64c.js"><link rel="prefetch" href="/blog/assets/js/14.80cd9f46.js"><link rel="prefetch" href="/blog/assets/js/15.db67f680.js"><link rel="prefetch" href="/blog/assets/js/16.a3cc2600.js"><link rel="prefetch" href="/blog/assets/js/17.30a20293.js"><link rel="prefetch" href="/blog/assets/js/18.abaa7e33.js"><link rel="prefetch" href="/blog/assets/js/19.c5dd4582.js"><link rel="prefetch" href="/blog/assets/js/20.3ee32d4a.js"><link rel="prefetch" href="/blog/assets/js/21.d7df4dff.js"><link rel="prefetch" href="/blog/assets/js/22.3cfc9a6c.js"><link rel="prefetch" href="/blog/assets/js/23.1e210814.js"><link rel="prefetch" href="/blog/assets/js/24.7f724dd0.js"><link rel="prefetch" href="/blog/assets/js/25.69362e2a.js"><link rel="prefetch" href="/blog/assets/js/26.7efec979.js"><link rel="prefetch" href="/blog/assets/js/27.baab02b4.js"><link rel="prefetch" href="/blog/assets/js/28.22708483.js"><link rel="prefetch" href="/blog/assets/js/29.8131a205.js"><link rel="prefetch" href="/blog/assets/js/3.91f35203.js"><link rel="prefetch" href="/blog/assets/js/30.1dcc6d5c.js"><link rel="prefetch" href="/blog/assets/js/31.cd647998.js"><link rel="prefetch" href="/blog/assets/js/32.f22a6677.js"><link rel="prefetch" href="/blog/assets/js/33.031d81c8.js"><link rel="prefetch" href="/blog/assets/js/34.dc2b0687.js"><link rel="prefetch" href="/blog/assets/js/35.55225650.js"><link rel="prefetch" href="/blog/assets/js/36.01a82d7c.js"><link rel="prefetch" href="/blog/assets/js/37.9e6b4b86.js"><link rel="prefetch" href="/blog/assets/js/38.947002a2.js"><link rel="prefetch" href="/blog/assets/js/39.d252a4d8.js"><link rel="prefetch" href="/blog/assets/js/4.d2bc884a.js"><link rel="prefetch" href="/blog/assets/js/5.8deafdd4.js"><link rel="prefetch" href="/blog/assets/js/6.b88d790a.js"><link rel="prefetch" href="/blog/assets/js/7.5a873c47.js"><link rel="prefetch" href="/blog/assets/js/8.b3ddc9f5.js"><link rel="prefetch" href="/blog/assets/js/9.45271a8d.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.0b1ac558.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">芦荟柚子茶的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/blog/projects/" class="nav-link router-link-active">
  项目
</a></div><div class="nav-item"><a href="/blog/record/" class="nav-link">
  记录
</a></div><div class="nav-item"><a href="/blog/fronted/" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/blog/backend/" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/blog/thanks/" class="nav-link">
  感谢
</a></div> <a href="https://github.com/lisheng741/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/blog/projects/" class="nav-link router-link-active">
  项目
</a></div><div class="nav-item"><a href="/blog/record/" class="nav-link">
  记录
</a></div><div class="nav-item"><a href="/blog/fronted/" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/blog/backend/" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/blog/thanks/" class="nav-link">
  感谢
</a></div> <a href="https://github.com/lisheng741/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>项目</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/projects/" aria-current="page" class="sidebar-link">目录</a></li><li><a href="/blog/projects/简单三层应用.html" class="active sidebar-link">基于.NET6的简单三层管理系统</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/projects/简单三层应用.html#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header"><a href="/blog/projects/简单三层应用.html#项目概述" class="sidebar-link">项目概述</a></li><li class="sidebar-sub-header"><a href="/blog/projects/简单三层应用.html#体验地址" class="sidebar-link">体验地址</a></li><li class="sidebar-sub-header"><a href="/blog/projects/简单三层应用.html#快速开始" class="sidebar-link">快速开始</a></li><li class="sidebar-sub-header"><a href="/blog/projects/简单三层应用.html#参考项目" class="sidebar-link">参考项目</a></li><li class="sidebar-sub-header"><a href="/blog/projects/简单三层应用.html#基本设计思路" class="sidebar-link">基本设计思路</a></li><li class="sidebar-sub-header"><a href="/blog/projects/简单三层应用.html#项目结构" class="sidebar-link">项目结构</a></li><li class="sidebar-sub-header"><a href="/blog/projects/简单三层应用.html#业务能力" class="sidebar-link">业务能力</a></li><li class="sidebar-sub-header"><a href="/blog/projects/简单三层应用.html#系统能力" class="sidebar-link">系统能力</a></li><li class="sidebar-sub-header"><a href="/blog/projects/简单三层应用.html#项目亮点" class="sidebar-link">项目亮点</a></li><li class="sidebar-sub-header"><a href="/blog/projects/简单三层应用.html#一些q-a" class="sidebar-link">一些Q&amp;A</a></li><li class="sidebar-sub-header"><a href="/blog/projects/简单三层应用.html#源码" class="sidebar-link">源码</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="基于-net6的简单三层管理系统"><a href="#基于-net6的简单三层管理系统" class="header-anchor">#</a> 基于.NET6的简单三层管理系统</h1> <h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>笔者前段时间搬砖的时候，有了一个偷懒的想法：如果开发的时候，简单的CURD可以由代码生成器完成，相应的实体、服务都不需要再做额外的注册，这样开发人员可以省了很多事。</p> <p>于是就开了这个项目，期望实现这样的能力：业务人员只需关注实体的构建，业务服务的编写，以及路由的配置。</p> <p>让业务的开发，变成简单的三步走：创建实体 &gt;&gt; 业务开发 &gt;&gt; 路由配置。</p> <p>目前项目构思的绝大部分能力已完成（代码生成器、定时任务还未实现），现将项目发布，希望能对搬砖的大家伙有所帮助。</p> <h2 id="项目概述"><a href="#项目概述" class="header-anchor">#</a> 项目概述</h2> <p>前后端分离，使用 JWT 认证。</p> <p>后端：基于 .NET6 和 EF Core，集成常用组件，采用传统三层结构。</p> <p>前端：基于 <a href="https://gitee.com/xiaonuobase/snowy" target="_blank" rel="noopener noreferrer">小诺1.8<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 做适配，主技术栈：Vue2.6.x、Ant-Design-Vue</p> <h2 id="体验地址"><a href="#体验地址" class="header-anchor">#</a> 体验地址</h2> <p>http://175.178.244.200:12060/</p> <p>管理员：superAdmin  密码：123456</p> <p>普通用户：user  密码：123456</p> <h2 id="快速开始"><a href="#快速开始" class="header-anchor">#</a> 快速开始</h2> <p>请参考项目文档：<a href="https://gitee.com/lisheng741/simpleapp/blob/master/doc/%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C.md" target="_blank" rel="noopener noreferrer">使用手册<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="参考项目"><a href="#参考项目" class="header-anchor">#</a> 参考项目</h2> <p>注：排名不分先后。</p> <p><a href="https://gitee.com/xiaonuobase/snowy" target="_blank" rel="noopener noreferrer">小诺 snowy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://gitee.com/zuohuaijun/Admin.NET" target="_blank" rel="noopener noreferrer">Admin.NET<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://gitee.com/laozhangIsPhi/Blog.Core" target="_blank" rel="noopener noreferrer">Blog.Core<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://github.com/AlphaYu/Adnc" target="_blank" rel="noopener noreferrer">Adnc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://gitee.com/dotnetchina/Furion" target="_blank" rel="noopener noreferrer">Furion<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://github.com/abpframework/abp" target="_blank" rel="noopener noreferrer">ABP<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>感谢这些优秀的开源项目！</p> <h2 id="基本设计思路"><a href="#基本设计思路" class="header-anchor">#</a> 基本设计思路</h2> <ul><li><p>依赖于抽象</p> <p>依赖倒置原则，控制反转（IoC）</p></li> <li><p>切面编程（AOP）</p> <p>权限、日志、异常等通过过滤器（Filter）或中间件（Middleware）等实现，集中编程</p></li> <li><p>可配置</p></li> <li><p>自动注册</p> <p>自动注册实体（Entity）、自动注册服务类（Service）等</p></li></ul> <h2 id="项目结构"><a href="#项目结构" class="header-anchor">#</a> 项目结构</h2> <h3 id="项目结构构思"><a href="#项目结构构思" class="header-anchor">#</a> 项目结构构思</h3> <p><img src="/blog/assets/img/image-20220916003303757.c9e70393.png" alt="image-20220916003303757"></p> <p><strong>主要分为三层：Interface表现层、Services服务层、Repository仓储层</strong></p> <p><strong>Interface</strong>：Host依赖所有层，完成程序配置（如：Program.cs 中DI容器注入服务，中间件管道配置等）；Web API 配置路由，提供 API 接口，如果程序以后有迁移、或替换前端的情况，也可以在这里做一层适配器（注：API只是一种表现形式，也可以为MVC）</p> <p><strong>Services</strong>：所有的业务都在这一层。从仓储中读取数据模型（Models），进行业务操作，返回DTO（Data transfer objects）给表现层。</p> <p><strong>Repository</strong>：数据库访问。</p> <p><strong>通用的模块：Model、Common、Framework</strong></p> <p><strong>Models</strong>：包含所有数据模型，如 Entity（对象数据库的数据表）、CacheItem缓存对象、EventModel事件模型等。</p> <p><strong>Common</strong>：集成常用组件，根据项目需要做相应配置；提供基础服务，如CurrentUser访问当前用户信息；提供静态帮助类，所有无状态的函数都归入此类，如<code>GuidHelper.Next()</code> 产生连续 Guid。</p> <p><strong>Framework</strong>：框架，比如引用ABP或Furion等框架，甚至是自己项目一些通用的能力，可以到处用的。</p> <h3 id="实际项目结构"><a href="#实际项目结构" class="header-anchor">#</a> 实际项目结构</h3> <p>实际上，把 IServices 和 IRepository 此类接口层干掉了。</p> <p>Models 则归入了对应的使用者里面，Framework 也没有。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>Common        <span class="token comment"># 基础设施：集成常用组件；提供基础服务；提供静态帮助类</span>
Repository    <span class="token comment"># 仓储层：数据库访问，数据库迁移</span>
Services      <span class="token comment"># 服务层：业务实现</span>
WebApi        <span class="token comment"># 表现层：完成程序配置；配置路由，提供API接口</span>
</code></pre></div><p>目录结构如下，更详细的结构，请查看文档。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>├─config                  <span class="token comment"># 一些配置文件，如：redis 的配置文件</span>
├─doc                     <span class="token comment"># 项目文档</span>
├─web                     <span class="token comment"># 前端</span>
├─webapi                  <span class="token comment"># 后端</span>
   ├─Simple.Common        <span class="token comment"># 基础设施</span>
   ├─Simple.Repository    <span class="token comment"># 仓储层</span>
   ├─Simple.Services      <span class="token comment"># 服务层</span>
   └─Simple.WebApi        <span class="token comment"># 表现层</span>
</code></pre></div><h2 id="业务能力"><a href="#业务能力" class="header-anchor">#</a> 业务能力</h2> <ul><li>组织架构
<ul><li>组织机构（organization）</li> <li>岗位（position）</li> <li>用户（user）</li></ul></li> <li>权限管理
<ul><li>应用（application）</li> <li>菜单（menu）</li> <li>角色（role）</li></ul></li> <li>开发管理
<ul><li>数据字典（dictionary、dictionaryItem）</li></ul></li> <li>日志管理
<ul><li>操作日志（log operating）</li> <li>异常日志（log exception）</li></ul></li></ul> <h2 id="系统能力"><a href="#系统能力" class="header-anchor">#</a> 系统能力</h2> <ul><li>认证：集成Cookies、JWT；默认启用 JWT</li> <li>授权：<a href="https://docs.microsoft.com/zh-cn/aspnet/core/security/authorization/policies?view=aspnetcore-6.0" target="_blank" rel="noopener noreferrer">基于策略（Policy）的授权<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>ORM：<a href="https://docs.microsoft.com/zh-cn/ef/core/" target="_blank" rel="noopener noreferrer">EF Core<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 的 <a href="https://docs.microsoft.com/zh-cn/ef/core/managing-schemas/migrations/?tabs=dotnet-core-cli" target="_blank" rel="noopener noreferrer">Code First 模式<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>依赖注入：默认 DI 容器，实现自动注入</li> <li>缓存：<a href="https://docs.microsoft.com/zh-cn/dotnet/api/microsoft.extensions.caching.distributed.idistributedcache" target="_blank" rel="noopener noreferrer">IDistributedCache<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，默认注入 Memory Cache，可替换 Redis</li> <li>日志：<a href="https://nlog-project.org/" target="_blank" rel="noopener noreferrer">NLog<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>事件总线：<a href="https://docs.microsoft.com/zh-cn/dotnet/core/extensions/queue-service?source=recommendations" target="_blank" rel="noopener noreferrer">默认启用 BackgroupService<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，基于<a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.threading.channels.channel-1" target="_blank" rel="noopener noreferrer">Channel<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 实现的单机版发布订阅；可替换为 Redis 的发布订阅（可用于分布式）；也可替换为 RabbitMQ 的发布订阅（可用于分布式）</li> <li>定时任务：Quartz</li> <li>数据验证：<a href="https://docs.microsoft.com/zh-cn/aspnet/core/mvc/models/validation" target="_blank" rel="noopener noreferrer">模型验证（Model validation）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>对象映射：AutoMapper</li></ul> <h2 id="项目亮点"><a href="#项目亮点" class="header-anchor">#</a> 项目亮点</h2> <ul><li><a href="https://gitee.com/lisheng741/simpleapp/blob/master/webapi/migrations.sh" target="_blank" rel="noopener noreferrer">EF Core 自动迁移脚本<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="一些q-a"><a href="#一些q-a" class="header-anchor">#</a> 一些Q&amp;A</h2> <h4 id="为什么把-iservices-这些接口层给干掉了-仅留下实现层"><a href="#为什么把-iservices-这些接口层给干掉了-仅留下实现层" class="header-anchor">#</a> 为什么把 IServices 这些接口层给干掉了，仅留下实现层？</h4> <p>答：一般项目中会如有 IRepository 和 IServices 这些个抽象层，主要是为了控制反转（IoC），实现项目各层之间解耦，最终目的就是为了“高内聚，低耦合”。</p> <p>笔者认为，对于单体项目来说，做到高内聚即可，再追求完全的低耦合，会增加成本和困扰（举个简单的栗子：项目初期，业务大改是常有的事，改服务类的接口的事并不少见。除非说业务主体明确，需要修改的，并不是业务的接口，而是业务的具体实现）。</p> <p>最后是这个项目，本就是为了追求最简三层单体。</p> <h4 id="为什么不对仓储额外封装一层"><a href="#为什么不对仓储额外封装一层" class="header-anchor">#</a> 为什么不对仓储额外封装一层？</h4> <p>答：简单的项目基本上是单数据库的，且 EF Core 已经实现了工作单元和仓储模式，可以不用再封装一层。</p> <p>当然，笔者还是建议跟ABP框架那样再封装一层仓储，可以避免一些后续的开发运维问题（比如：系统迁移、重构等）。</p> <h2 id="源码"><a href="#源码" class="header-anchor">#</a> 源码</h2> <p>Gitee：https://gitee.com/lisheng741/simpleapp</p> <p>Github：https://github.com/lisheng741/SimpleApp</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/lisheng741/blog/edit/master/docs/projects/简单三层应用.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/9/16 18:56:25</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/projects/" class="prev router-link-active">
        目录
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.558beeb7.js" defer></script><script src="/blog/assets/js/2.c9b070a5.js" defer></script><script src="/blog/assets/js/12.366feb7b.js" defer></script>
  </body>
</html>
